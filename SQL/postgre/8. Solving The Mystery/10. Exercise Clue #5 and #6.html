<p>Oh boy, this is turning into a doozy of a mystery. Bruno was right all along!</p><p>For this part of the mystery, we're going to have to do something special. We're going to have to cross-reference data between 2 separate databases. That's crazy! How do we do that?</p><p><br></p><p>Not to worry, it's simpler than it sounds. Just like when we generated those UUID's we need to add a new extension to our database and so we need to install it!</p><p><code> <strong>create extension dblink; -- run this to run queries across databases</strong></code></p><p><br></p><p>This will install a special utility called <a href="https://www.postgresql.org/docs/9.3/dblink.html" rel="noopener noreferrer" target="_blank"><strong>dblink</strong></a><strong> </strong>that we can then use to query and filter across databases.</p><p>Here's an example on how to use <a href="https://www.postgresql.org/docs/9.3/dblink.html" rel="noopener noreferrer" target="_blank"><strong>dblink</strong></a></p><pre class="prettyprint linenums">SELECT *
FROM dblink('host=localhost user=postgres password=postgres dbname=Employees', 'SELECT &lt;column&gt; FROM employees;') AS t1(&lt;column&gt; NAME) </pre><p><br></p><p>- In the above query, you must be aware that the <strong>AS </strong>clause in the from statement is extremely important to be able to correctly refer to and work with the selected data</p><p>- Also note that it is a bit different than the normal syntax we've seen as with dblink. You must return an alias that maps the columns returned and the <strong>NAME&nbsp;</strong>identifier you see is doing just that</p><p>- Try to write a query with the above that returns the first and last name, but make sure you're running this query from the Movr database </p><p><br></p><p>Now that we're dblink masters, let's get on to the more interesting query.</p><p>1. We need to create a view that solely contains the first and last name separated of the suspected riders, as their name field contains both first and last name combined. Use the SQL&nbsp;function <a href="https://www.postgresql.org/docs/9.1/functions-string.html" rel="noopener noreferrer" target="_blank"><strong>split_part</strong></a><strong> </strong>to split the rider's name into two segments (first_name, last_name)!</p><p><br></p><p>2. Then we need to write a query that connects to the Employee database with <a href="https://www.postgresql.org/docs/9.3/dblink.html" rel="noopener noreferrer" target="_blank"><strong>dblink</strong></a><strong> </strong>and cross-reference the first and last names of the riders against the names of the Employees</p><p><br></p><p>With the information from this query, we should be able to narrow down who did it!</p>